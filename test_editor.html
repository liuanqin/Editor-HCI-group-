<!doctype html>
<html lang="en">
<head>
  <title>ND HCI Group -- Code Editor</title>

<script type="text/javascript" src="./caretposition.js"></script>
<script type="text/javascript" src="./background.js"></script>
<script type="text/javascript" src="./recognition.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

</head>
<body onload="init()">
<h1>Code Editor</h1>

<div id="links">
<input type="button" value="Type"  onclick="reset('board'); up('canvas-text-editor');moveCaretToEnd('myTextArea');document.getElementById('myTextArea').focus(); ">
<input type="button" value="Write" onclick="reset('canvas-text-editor'); up('board');moveCaretToEnd('myTextArea');hideKeyboard;document.getElementById('myTextArea').focus();readonly='true'; ">
<div id="canvas-text-editor">
  <textarea id="myTextArea" hideKeyboard; atuofocus></textarea>

</div>

<div id="board">

    <br/>
    <canvas id="canvas" ></canvas>
    <br/>
    <pre id="result"><em style="color: white;"></em></pre>

</div>
<style type="text/css" media="screen">
html, body {
	width: 100%;
	height: 100%;
}
#canvas-text-editor{
    position:absolute; top:18%; left:0; right:0; bottom:0;
    width:100%;
    height: 100%;
    margin:5px 0;
    padding:3px;
    z-index:-1;
    overflow-y: : hidden;
    box-sizing: border-box;         /* For IE and modern versions of Chrome */
  -moz-box-sizing: border-box;    /* For Firefox                          */
  -webkit-box-sizing: border-box;
}
#canvas{
  position:absolute; top:0; left:0; right:0; bottom:0;
  width:100%;
  height: 100%;
  overflow-y: : hidden;
  z-index:1;
  box-sizing: border-box;         /* For IE and modern versions of Chrome */
-moz-box-sizing: border-box;    /* For Firefox                          */
-webkit-box-sizing: border-box;
}
#board{
  position:absolute; top:18%; left:0; right:0; bottom:0;
  width:100%;
  height: 100%;
  overflow-y: : hidden;
  z-index:1;
  box-sizing: border-box;         /* For IE and modern versions of Chrome */
-moz-box-sizing: border-box;    /* For Firefox                          */
-webkit-box-sizing: border-box;
}
textarea
{
  position:absolute; top:0; left:0; right:0; bottom:0;
  border:1px solid #999999;
  width:100%;
  height: 100%;
  margin:5px 0;
  padding:3px;
  overflow-y: : hidden;
  font-family:Times New Roman;
   font-size: 26px;
  box-sizing: border-box;         /* For IE and modern versions of Chrome */
-moz-box-sizing: border-box;    /* For Firefox                          */
-webkit-box-sizing: border-box;
}
</style>

</body>

<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/core-min.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/x64-core-min.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/sha512-min.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/hmac-min.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/q.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/sample/lib/hand.minified-1.3.8.js"></script>
<script type="text/javascript" src="MyScript_Cloud-text-JS_Sample/myscript.min.js"></script>

<script type="text/javascript" >

    var result = document.getElementById('result');
    var canvas = document.getElementById('canvas');
    //var trash = document.getElementById('trash');
    //var undo = document.getElementById('undo');
    //var redo = document.getElementById('redo');
    //var languages = document.getElementById('languages');
    var context = canvas.getContext('2d');
    var pointerId;

    var applicationKey =  "1b96efa9-7fc3-4bf2-8881-db20c37b556e";
    var hmacKey =  "c504e889-4716-436c-8bd9-e4af59f546ef";

    var inkManager = new MyScript.InkManager();
    var textRenderer = new MyScript.TextRenderer();
    var textRecognizer = new MyScript.TextRecognizer();
    var instanceId;

    canvas.addEventListener('pointerdown', function (event) {
        if (!pointerId) {
            pointerId = event.pointerId;
            event.preventDefault();

            textRenderer.drawStart(event.offsetX, event.offsetY);
            inkManager.startInkCapture(event.offsetX, event.offsetY);
        }
    }, false);

    canvas.addEventListener('pointermove', function (event) {
        if (pointerId === event.pointerId) {
            event.preventDefault();

            textRenderer.drawContinue(event.offsetX, event.offsetY, context);
            inkManager.continueInkCapture(event.offsetX, event.offsetY);
        }
    }, false);

    var timer = (new Date()).getTime();
    canvas.addEventListener('pointerup', function (event) {
        if (pointerId === event.pointerId) {

            event.preventDefault();

            textRenderer.drawEnd(event.offsetX, event.offsetY, context);
            inkManager.endInkCapture();
            timer = (new Date()).getTime();                //onClickCheck();
      
       pointerId = undefined;
      //doRecognition();
}
    }, false);


    canvas.addEventListener('pointerleave', function (event) {
        if (pointerId === event.pointerId) {
            event.preventDefault();

            textRenderer.drawEnd(event.offsetX, event.offsetY, context);
            inkManager.endInkCapture();
            pointerId = undefined;
            doRecognition();

        }
    }, false);

    var myVar = setInterval(function(){ onClickCheck() }, 500);

    var canvas = document.getElementById('canvas');
    var parent = document.getElementById('board');

    canvas.height = parent.offsetHeight;
    canvas.width = parent.offsetWidth;

       setInterval(function () {
       var textArea = document.getElementById("myTextArea");
       var caretPosition = Measurement.caretPos(textArea);
      // console.log(caretPosition.left);
       //console.log(caretPosition.top);
     },2000);

     var lastFocused;
     $("#myTextArea").focus(function() {
       lastFocused = document.activeElement;
     });


</script>
</html>
